Aquest es el procedure d'otorgar permissos de la taula Azkanan
``
CREATE PROCEDURE OtorgarPermís
	@Número_Pres int, @data_inici date, @dies_permís int
AS BEGIN
	--Comprovar si el pres ha complert el 50% de la seva condemna
	DECLARE @percentatge as int
	SET @percentatge = dbo.percentage_complert (@Número_pres);
	if (@percentatge < 50)
		BEGIN
			RAISERROR ('No es pot otorgar el permís el pres no ha complert el 50% de la seva condemna', 1, 1)
		END
	--Comprovar si hi ha solapaments amb altres permissos
	DECLARE @data_final date
  --Don valor a la varaible data_final
	SELECT @data_final = DATEADD (DAY, @dies_permís, @data_inici)
	DECLARE @solapaments as int
  --Conta el nombre de solapaments
	SELECT @solapaments = COUNT(*)
			FROM Permíssos P
			WHERE NOT(P.fins_a < @data_final OR P.des_de > @data_final) AND
					P.Número_pres = @Número_Pres
	if (@solapaments>0)
		BEGIN
			RAISERROR ('No es pot donar el permís se solapa en un altre', 1, 1)
		END
  --Inserta les dades en el cas de que no hi hagi solapaments
	else
		BEGIN
			INSERT into Permíssos (des_de, fins_a, Número_pres)
				values (@data_inici, @data_final, @Número_Pres);
		END
END
``
